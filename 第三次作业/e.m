function [ f,g,G ] = e( x,phi )
%UNTITLED 此处显示有关此函数的摘要
%   此处显示详细说明
theta = pi*phi;
r = zeros(4,1);
co = cos(theta);
for i = 0:3
    a = x(i*2+1);
    b = x(i*2+2);
    r(i+1) = 1 + a^2 + b^2 + 2*b*(2*co^2-1) + 2*a*(1+b)*co;
end
H = x(9) * (r(1)*r(3)/r(2)/r(4))^(1/2);
f = H - abs(1-2*phi);
if nargout > 1
    g = zeros(9,1);
    g(9) = (r(1)*r(3)/r(2)/r(4))^(1/2);

        
    for i = 0:3
        a = x(i*2+1);
        b = x(i*2+2);
        g(2*i+1) = (-1)^i*H/2/r(i+1)*(2*a+2*(1+b)*co);
        g(2*i+2) = (-1)^i*H/2/r(i+1)*(2*b+2*a*co+2*(2*co^2-1));
    end
    G = zeros(9);
    G(1:8,9) = g(1:8)/x(9);
    G(9,1:8) = G(1:8,9)';
    a = x(1);
    b = x(2);
    G(1,1) = H/r(1)- (2*a+2*(1+b)*co)^2*H/4/r(1)^2;
    G(1,2) = co*H/r(1) - (2*a+2*(1+b)*co)*(2*b+2*a*co+2*(2*co^2-1))*H/4/r(1)^2;
    G(2,2) = H/r(1)- (2*b+2*a*co+2*(2*co^2-1))^2*H/4/r(1)^2;
    for i = 1:3
        a = x(i*2+1);
        b = x(i*2+2);
        G(1,2*i+1) = (-1)^i*g(1)/2/r(i+1)*(2*a+2*(1+b)*co);
        G(1,2*i+2) = (-1)^i*g(1)/2/r(i+1)*(2*b+2*a*co+2*(2*co^2-1));
        G(2,2*i+1) = (-1)^i*g(2)/2/r(i+1)*(2*a+2*(1+b)*co);
        G(2,2*i+2) = (-1)^i*g(2)/2/r(i+1)*(2*b+2*a*co+2*(2*co^2-1));
    end
    G(3,3) = -H/r(2)+3* (2*x(3)+2*(1+x(4))*co)^2*H/4/r(2)^2;
    G(3,4) = -co*H/r(2) +3* (2*x(3)+2*(1+x(4))*co)*(2*x(4)+2*x(1)*co+2*(2*co^2-1))*H/4/r(2)^2;
    G(4,4) = -H/r(2)+3* (2*x(4)+2*x(3)*co+2*(2*co^2-1))^2*H/4/r(2)^2;
    for i = 2:3
        a = x(i*2+1);
        b = x(i*2+2);
        G(3,2*i+1) = (-1)^i*g(3)/2/r(i+1)*(2*a+2*(1+b)*co);
        G(3,2*i+2) = (-1)^i*g(3)/2/r(i+1)*(2*b+2*a*co+2*(2*co^2-1));
        G(4,2*i+1) = (-1)^i*g(4)/2/r(i+1)*(2*a+2*(1+b)*co);
        G(4,2*i+2) = (-1)^i*g(4)/2/r(i+1)*(2*b+2*a*co+2*(2*co^2-1));
    end
    G(5,5) = H/r(3)- (2*x(5)+2*(1+x(6))*co)^2*H/4/r(3)^2;
    G(5,6) = co*H/r(3) -  (2*x(5)+2*(1+x(6))*co)*(2*x(6)+2*x(5)*co+2*(2*co^2-1))*H/4/r(3)^2;
    G(6,6) = H/r(3)-(2*x(6)+2*x(5)*co+2*(2*co^2-1))^2*H/4/r(3)^2;
    for i = 3:3
        a = x(i*2+1);
        b = x(i*2+2);
        G(5,2*i+1) = (-1)^i*g(5)/2/r(i+1)*(2*a+2*(1+b)*co);
        G(5,2*i+2) = (-1)^i*g(5)/2/r(i+1)*(2*b+2*a*co+2*(2*co^2-1));
        G(6,2*i+1) = (-1)^i*g(6)/2/r(i+1)*(2*a+2*(1+b)*co);
        G(6,2*i+2) = (-1)^i*g(6)/2/r(i+1)*(2*b+2*a*co+2*(2*co^2-1));
    end
    G(7,7) = -H/r(4)+3* (2*x(7)+2*(1+x(8))*co)^2*H/4/r(4)^2;
    G(7,8) = -co*H/r(4) +3*(2*x(7)+2*(1+x(8))*co)*(2*x(8)+2*x(7)*co+2*(2*co^2-1))*H/4/r(4)^2;
    G(8,8) = -H/r(4)+3* (2*x(8)+2*x(7)*co+2*(2*co^2-1))^2*H/4/r(4)^2;
    for i = 1:7
        G(i+1:8,i) = G(i,i+1:8);
    end
end

end

